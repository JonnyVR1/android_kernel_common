Revision: 5de95d7315f70b8ea06c6306e554100a051de50f
Patch-set: 6
File: fs/open.c

106
Thu Sep 17 23:54:06 2015 +0000
Author: Stephen Smalley <1010099@85c56323-6fa9-3386-8a01-6480fb634889>
UUID: a9bdafe7_77c27071
Bytes: 838
vfs maintainers will hate having two security hooks right next to each other like this.  If you really want this, then we would either need to enable CONFIG_SECURITY_PATH for SELinux and implement the security_path_truncate() hook, with an additional flag, or re-think open permission.  Eric at one time suggested that open permission should be repurposed or replaced by a new permission that gets checked at the tail of pathname lookup (I think he called it name_resolve or something, but I would just call it lookup), so that one can prevent all pathname-based calls on a file by not allowing lookup permission to it.  But such a permission is only useful/necessary if you have to allow search to the parent directory type; otherwise, search permission suffices to prevent any pathname-based system calls on files within that directory.

106
Fri Sep 18 00:14:30 2015 +0000
Author: Jeffrey Vander Stoep <1054468@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: a9bdafe7_77c27071
UUID: 69dad736_4387dada
Bytes: 75
What do you suggest? Your CONFIG_SECURITY_PATH idea seems straight forward.

106
Fri Sep 18 13:28:15 2015 +0000
Author: Stephen Smalley <1010111@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: 69dad736_4387dada
UUID: c97ca3f3_e830b383
Bytes: 889
Well, it would be a big conceptual change for SELinux, as those hooks were only added for the pathname-based security modules (AppArmor, TOMOYO) and everywhere else we are using inode-based hooks that occur deeper in the kernel (and less likely to be bypassed by other callers of the vfs helper functions). I could also see objections due to the fact that no other hook tries to make this distinction between pathname-based system call and fd-based system call, so there would be a lack of parallelism in the hooks unless similar arguments were added to them all.
Adding a new lookup permission check at the tail of pathname resolution would be more consistent with SELinux design and would address all pathname-based system calls, but that is obviously a performance critical path.
Wait...can't we just check for ATTR_FILE in selinux_inode_setattr() and not set FILE__OPEN if that is set?

106
Fri Sep 18 15:39:35 2015 +0000
Author: Jeffrey Vander Stoep <1054468@85c56323-6fa9-3386-8a01-6480fb634889>
Parent: c97ca3f3_e830b383
UUID: 29bd3fca_1c2539ef
Bytes: 11
Checking...

